{"version":3,"sources":["../../src/middleware/authantication.js"],"names":["db","require","passport","JwtStrategy","Strategy","ExtractJwt","config","opts","jwtFromRequest","fromAuthHeaderAsBearerToken","secretOrKey","secret","use","jwt_payload","callback","console","log","register_user","find","_id","id","exec","err","user"],"mappings":";;AAAA,IAAIA,KAAKC,QAAQ,UAAR,CAAT;AACA,IAAIC,WAAWD,QAAQ,UAAR,CAAf;AACA,IAAIE,cAAcF,QAAQ,cAAR,EAAwBG,QAA1C;AAAA,IACIC,aAAaJ,QAAQ,cAAR,EAAwBI,UADzC;AAEA,IAAIC,SAASL,QAAQ,sBAAR,CAAb;;AAEA,IAAIM,OAAO,EAAX;AACAA,KAAKC,cAAL,GAAsBH,WAAWI,2BAAX,EAAtB;AACAF,KAAKG,WAAL,GAAmBJ,OAAOK,MAA1B;AACAT,SAASU,GAAT,CAAa,IAAIT,WAAJ,CAAgBI,IAAhB,EAAsB,UAASM,WAAT,EAAsBC,QAAtB,EAAgC;AAC/DC,YAAQC,GAAR,CAAY,kBAAZ,EAAgCH,WAAhC;AACAb,OAAGiB,aAAH,CAAiBC,IAAjB,CAAsB,EAAEC,KAAKN,YAAYO,EAAnB,EAAtB,EAA+CC,IAA/C,CAAoD,UAASC,GAAT,EAAcC,IAAd,EAAoB;AACpER,gBAAQC,GAAR,CAAYO,IAAZ;AACA,YAAID,GAAJ,EAAS;AACL,mBAAOR,SAASQ,GAAT,EAAc,IAAd,CAAP;AACH,SAFD,MAEO,IAAI,CAACC,IAAL,EAAW;AACd,mBAAOT,SAAS,IAAT,EAAe,KAAf,CAAP;AACH,SAFM,MAEA;AACH,mBAAOA,SAAS,IAAT,EAAeS,IAAf,CAAP;AACH;AACJ,KATD;AAUH,CAZY,CAAb","file":"authantication.js","sourcesContent":["var db = require('../db.js');\nvar passport = require('passport');\nvar JwtStrategy = require('passport-jwt').Strategy,\n    ExtractJwt = require('passport-jwt').ExtractJwt;\nvar config = require('../middleware/config');\n\nvar opts = {};\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();\nopts.secretOrKey = config.secret;\npassport.use(new JwtStrategy(opts, function(jwt_payload, callback) {\n    console.log('payload received', jwt_payload);\n    db.register_user.find({ _id: jwt_payload.id }).exec(function(err, user) {\n        console.log(user)\n        if (err) {\n            return callback(err, null);\n        } else if (!user) {\n            return callback(null, false);\n        } else {\n            return callback(null, user);\n        }\n    });\n}));"]}